---
title: "Testing Database"
runtime: shiny
---

<style type="text/css">
.title {
  display: none;
}
img {
  border-radius: 200px 200px 200px 200px;
}

</style>

```{r, echo=FALSE}
library(shiny)

citations_data <- data.frame(
  Citation = c("Citation 1", "Citation 2", "Citation 3", "Citation 4"),
  Tags = c("Tag1", "Tag2", "Tag1", "Tag3")
)

ui <- fluidPage(
  titlePanel("Citation search function"),
  sidebarLayout(
    sidebarPanel(
      textInput("searchInput", "Search Citations"),
      checkboxGroupInput("tags", "Select Tags", choices = unique(citations_data$Tags), selected = unique(citations_data$Tags))
    ),
    mainPanel(
      uiOutput("citationsList")
    )
  )
)


server <- function(input, output) {
  citations_data <- data.frame(
    Citation = c("Citation 1", "Citation 2", "Citation 3", "Citation 4"),
    Tags = c("Tag1", "Tag2", "Tag1", "Tag3")
  )

  output$citationsList <- renderUI({
    searchTerm <- tolower(input$searchInput)
    selectedTags <- input$tags

    if (is.null(searchTerm) && is.null(selectedTags)) {
      # If no search term or tags are specified, display all citations
      citationsToDisplay <- citations_data$Citation
    } else {
      # Otherwise, filter citations based on the search term and selected tags
      filteredCitations <- subset(citations_data, grepl(searchTerm, tolower(Citation)) & (Tags %in% selectedTags))
      citationsToDisplay <- filteredCitations$Citation
    }

    if (length(citationsToDisplay) > 0) {
      lapply(citationsToDisplay, function(citation) {
        p(citation)
      })
    } else {
      p("No matching citations found.")
    }
  })
}


shinyApp(ui, server)

```



